--plv8.start_proc = 'init_plv8'
CREATE EXTENSION IF NOT EXISTS plv8;
DROP function IF EXISTS init_plv8();
create or replace function init_plv8() returns boolean as $$
if(typeof console !== "undefined") return;(function(){function c(e){return function(f){return{}.toString.call(f)=="[object "+e+"]"}}var d=c("Function");var b={};function a(){}a.prototype.exec=function(){var h=this;if(this.execed){return h.exports}this.execed=true;function g(i){return a.get(i).exec()}var f=h.factory;var e=d(f)?f(g,h.exports={},h):f;if(e===undefined){e=h.exports}delete h.factory;h.exports=e;return e};define=function(h,g,e){var f={id:h,deps:g,factory:e};a.save(f)};a.save=function(f){var e=a.get(f.id);e.id=f.id;e.dependencies=f.deps;e.factory=f.factory};a.get=function(e){return b[e]||(b[e]=new a())};require=function(f){var e=a.get(f);if(!e.execed){e.exec()}return e.exports};this.define=define;this.require=require}).call();
(function(){this.console={};console=this.console;console.log=function(){var b=[];b.push(NOTICE);for(var c=0;c<arguments.length;c++){var a=arguments[c];if(typeof(a)==="object"){a=JSON.stringify(a)}b.push(a)}plv8.elog.apply(plv8,b)};console.warn=function(){var b=[];b.push(WARNING);for(var c=0;c<arguments.length;c++){var a=arguments[c];if(typeof(a)==="object"){a=JSON.stringify(a)}b.push(a)}plv8.elog.apply(plv8,b)};console.error=function(){var b=[];b.push(ERROR);for(var c=0;c<arguments.length;c++){var a=arguments[c];if(typeof(a)==="object"){a=JSON.stringify(a)}b.push(a)}plv8.elog.apply(plv8,b)};console.__beginTime={};console.time=function(a){if(!a){return}console.__beginTime[a]=(new Date()).getTime()};console.timeEnd=function(b){if(!b){return}var a=console.__beginTime[b];if(!a){return}plv8.elog(NOTICE,b+": "+((new Date()).getTime()-a))+"ms"}}).call();
(function(){var o=this.typeOf=function(i){if(i==null){return"null"}if(i.$family!=null){return i.$family()}if(i.nodeName){if(i.nodeType==1){return"element"}if(i.nodeType==3){return(/\S/).test(i.nodeValue)?"textnode":"whitespace"}}else{if(typeof i.length=="number"){if("callee" in i){return"arguments"}if("item" in i){return"collection"}}}return typeof i};var j=this.instanceOf=function(t,i){if(t==null){return false}var s=t.$constructor||t.constructor;while(s){if(s===i){return true}s=s.parent}return t instanceof i};var f=this.Function;var p=true;for(var k in {toString:1}){p=null}if(p){p=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]}f.prototype.overloadSetter=function(s){var i=this;return function(u,t){if(u==null){return this}if(s||typeof u!="string"){for(var v in u){i.call(this,v,u[v])}if(p){for(var w=p.length;w--;){v=p[w];if(u.hasOwnProperty(v)){i.call(this,v,u[v])}}}}else{i.call(this,u,t)}return this}};f.prototype.overloadGetter=function(s){var i=this;return function(u){var v,t;if(typeof u!="string"){v=u}else{if(arguments.length>1){v=arguments}else{if(s){v=[u]}}}if(v){t={};for(var w=0;w<v.length;w++){t[v[w]]=i.call(this,v[w])}}else{t=i.call(this,u)}return t}};f.prototype.extend=function(i,s){this[i]=s}.overloadSetter();f.prototype.implement=function(i,s){this.prototype[i]=s}.overloadSetter();var n=Array.prototype.slice;f.from=function(i){return(o(i)=="function")?i:function(){return i}};Array.from=function(i){if(i==null){return[]}return(a.isEnumerable(i)&&typeof i!="string")?(o(i)=="array")?i:n.call(i):[i]};Number.from=function(s){var i=parseFloat(s);return isFinite(i)?i:null};String.from=function(i){return i+""};f.implement({hide:function(){this.$hidden=true;return this},protect:function(){this.$protected=true;return this}});var a=this.Type=function(u,t){if(u){var s=u.toLowerCase();var i=function(v){return(o(v)==s)};a["is"+u]=i;if(t!=null){t.prototype.$family=(function(){return s}).hide()}}if(t==null){return null}t.extend(this);t.$constructor=a;t.prototype.$constructor=t;return t};var e=Object.prototype.toString;a.isEnumerable=function(i){return(i!=null&&typeof i.length=="number"&&e.call(i)!="[object Function]")};var q={};var r=function(i){var s=o(i.prototype);return q[s]||(q[s]=[])};var b=function(t,x){if(x&&x.$hidden){return}var s=r(this);for(var u=0;u<s.length;u++){var w=s[u];if(o(w)=="type"){b.call(w,t,x)}else{w.call(this,t,x)}}var v=this.prototype[t];if(v==null||!v.$protected){this.prototype[t]=x}if(this[t]==null&&o(x)=="function"){m.call(this,t,function(i){return x.apply(i,n.call(arguments,1))})}};var m=function(i,t){if(t&&t.$hidden){return}var s=this[i];if(s==null||!s.$protected){this[i]=t}};a.implement({implement:b.overloadSetter(),extend:m.overloadSetter(),alias:function(i,s){b.call(this,i,this.prototype[s])}.overloadSetter(),mirror:function(i){r(this).push(i);return this}});new a("Type",a);var d=function(s,x,v){var u=(x!=Object),B=x.prototype;if(u){x=new a(s,x)}for(var y=0,w=v.length;y<w;y++){var C=v[y],A=x[C],z=B[C];if(A){A.protect()}if(u&&z){x.implement(C,z.protect())}}if(u){var t=B.propertyIsEnumerable(v[0]);x.forEachMethod=function(G){if(!t){for(var F=0,D=v.length;F<D;F++){G.call(B,B[v[F]],v[F])}}for(var E in B){G.call(B,B[E],E)}}}return d};d("String",String,["charAt","charCodeAt","concat","contains","indexOf","lastIndexOf","match","quote","replace","search","slice","split","substr","substring","trim","toLowerCase","toUpperCase"])("Array",Array,["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","indexOf","lastIndexOf","filter","forEach","every","map","some","reduce","reduceRight"])("Number",Number,["toExponential","toFixed","toLocaleString","toPrecision"])("Function",f,["apply","call","bind"])("RegExp",RegExp,["exec","test"])("Object",Object,["create","defineProperty","defineProperties","keys","getPrototypeOf","getOwnPropertyDescriptor","getOwnPropertyNames","preventExtensions","isExtensible","seal","isSealed","freeze","isFrozen"])("Date",Date,["now"]);Object.extend=m.overloadSetter();Date.extend("now",function(){return +(new Date)});new a("Boolean",Boolean);Number.prototype.$family=function(){return isFinite(this)?"number":"null"}.hide();Number.extend("random",function(s,i){return Math.floor(Math.random()*(i-s+1)+s)});var g=Object.prototype.hasOwnProperty;Object.extend("forEach",function(i,t,u){for(var s in i){if(g.call(i,s)){t.call(u,i[s],s,i)}}});Object.each=Object.forEach;Array.implement({each:function(i,s){Array.forEach(this,i,s);return this}});var l=function(i){switch(o(i)){case"array":return i.clone();case"object":return Object.clone(i);default:return i}};Array.implement("clone",function(){var s=this.length,t=new Array(s);while(s--){t[s]=l(this[s])}return t});var h=function(s,i,t){switch(o(t)){case"object":if(o(s[i])=="object"){Object.merge(s[i],t)}else{s[i]=Object.clone(t)}break;case"array":s[i]=t.clone();break;default:s[i]=t}return s};Object.extend({merge:function(z,u,t){if(o(u)=="string"){return h(z,u,t)}for(var y=1,s=arguments.length;y<s;y++){var w=arguments[y];for(var x in w){h(z,x,w[x])}}return z},clone:function(i){var t={};for(var s in i){t[s]=l(i[s])}return t},append:function(w){for(var v=1,t=arguments.length;v<t;v++){var s=arguments[v]||{};for(var u in s){w[u]=s[u]}}return w}});["Object","WhiteSpace","TextNode","Collection","Arguments"].each(function(i){new a(i)});var c=Date.now();String.extend("uniqueID",function(){return(c++).toString(36)})})();Array.implement({clean:function(){return this.filter(function(a){return a!=null})},invoke:function(a){var b=Array.slice(arguments,1);return this.map(function(c){return c[a].apply(c,b)})},associate:function(c){var d={},b=Math.min(this.length,c.length);for(var a=0;a<b;a++){d[c[a]]=this[a]}return d},link:function(c){var a={};for(var e=0,b=this.length;e<b;e++){for(var d in c){if(c[d](this[e])){a[d]=this[e];delete c[d];break}}}return a},contains:function(a,b){return this.indexOf(a,b)!=-1},append:function(a){this.push.apply(this,a);return this},getLast:function(){return(this.length)?this[this.length-1]:null},getRandom:function(){return(this.length)?this[Number.random(0,this.length-1)]:null},include:function(a){if(!this.contains(a)){this.push(a)}return this},combine:function(c){for(var b=0,a=c.length;b<a;b++){this.include(c[b])}return this},erase:function(b){for(var a=this.length;a--;){if(this[a]===b){this.splice(a,1)}}return this},empty:function(){this.length=0;return this},flatten:function(){var d=[];for(var b=0,a=this.length;b<a;b++){var c=typeOf(this[b]);if(c=="null"){continue}d=d.concat((c=="array"||c=="collection"||c=="arguments"||instanceOf(this[b],Array))?Array.flatten(this[b]):this[b])}return d},pick:function(){for(var b=0,a=this.length;b<a;b++){if(this[b]!=null){return this[b]}}return null},hexToRgb:function(b){if(this.length!=3){return null}var a=this.map(function(c){if(c.length==1){c+=c}return parseInt(c,16)});return(b)?a:"rgb("+a+")"},rgbToHex:function(d){if(this.length<3){return null}if(this.length==4&&this[3]==0&&!d){return"transparent"}var b=[];for(var a=0;a<3;a++){var c=(this[a]-0).toString(16);b.push((c.length==1)?"0"+c:c)}return(d)?b:"#"+b.join("")}});String.implement({contains:function(b,a){return(a?String(this).slice(a):String(this)).indexOf(b)>-1},test:function(a,b){return((typeOf(a)=="regexp")?a:new RegExp(""+a,b)).test(this)},clean:function(){return String(this).replace(/\s+/g," ").trim()},camelCase:function(){return String(this).replace(/-\D/g,function(a){return a.charAt(1).toUpperCase()})},hyphenate:function(){return String(this).replace(/[A-Z]/g,function(a){return("-"+a.charAt(0).toLowerCase())})},capitalize:function(){return String(this).replace(/\b[a-z]/g,function(a){return a.toUpperCase()})},escapeRegExp:function(){return String(this).replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},toInt:function(a){return parseInt(this,a||10)},toFloat:function(){return parseFloat(this)},hexToRgb:function(b){var a=String(this).match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);return(a)?a.slice(1).hexToRgb(b):null},rgbToHex:function(b){var a=String(this).match(/\d{1,3}/g);return(a)?a.rgbToHex(b):null},substitute:function(a,b){return String(this).replace(b||(/\\?\{([^{}]+)\}/g),function(d,c){if(d.charAt(0)=="\\"){return d.slice(1)}return(a[c]!=null)?a[c]:""})}});Number.implement({limit:function(b,a){return Math.min(a,Math.max(b,this))},round:function(a){a=Math.pow(10,a||0).toFixed(a<0?-a:0);return Math.round(this*a)/a},times:function(b,c){for(var a=0;a<this;a++){b.call(c,a,this)}},toFloat:function(){return parseFloat(this)},toInt:function(a){return parseInt(this,a||10)}});Number.alias("each","times");(function(b){var a={};b.each(function(c){if(!Number[c]){a[c]=function(){return Math[c].apply(null,[this].concat(Array.from(arguments)))}}});Number.implement(a)})(["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","sin","sqrt","tan"]);Function.extend({attempt:function(){for(var b=0,a=arguments.length;b<a;b++){try{return arguments[b]()}catch(c){}}return null}});Function.implement({attempt:function(a,c){try{return this.apply(c,Array.from(a))}catch(b){}return null},pass:function(b,c){var a=this;if(b!=null){b=Array.from(b)}return function(){return a.apply(c,b||arguments)}},delay:function(b,c,a){return setTimeout(this.pass((a==null?[]:a),c),b)},periodical:function(c,b,a){return setInterval(this.pass((a==null?[]:a),b),c)}});(function(){var a=Object.prototype.hasOwnProperty;Object.extend({subset:function(d,g){var f={};for(var e=0,b=g.length;e<b;e++){var c=g[e];if(c in d){f[c]=d[c]}}return f},map:function(b,e,f){var d={};for(var c in b){if(a.call(b,c)){d[c]=e.call(f,b[c],c,b)}}return d},filter:function(b,e,g){var d={};for(var c in b){var f=b[c];if(a.call(b,c)&&e.call(g,f,c,b)){d[c]=f}}return d},every:function(b,d,e){for(var c in b){if(a.call(b,c)&&!d.call(e,b[c],c)){return false}}return true},some:function(b,d,e){for(var c in b){if(a.call(b,c)&&d.call(e,b[c],c)){return true}}return false},values:function(c){var b=[];for(var d in c){if(a.call(c,d)){b.push(c[d])}}return b},getLength:function(b){return Object.keys(b).length},keyOf:function(b,d){for(var c in b){if(a.call(b,c)&&b[c]===d){return c}}return null},contains:function(b,c){return Object.keyOf(b,c)!=null},toQueryString:function(b,c){var d=[];Object.each(b,function(h,g){if(c){g=c+"["+g+"]"}var f;switch(typeOf(h)){case"object":f=Object.toQueryString(h,g);break;case"array":var e={};h.each(function(k,j){e[j]=k});f=Object.toQueryString(e,g);break;default:f=g+"="+encodeURIComponent(h)}if(h!=null){d.push(f)}});return d.join("&")}})})();(function(){var a=this.Class=new Type("Class",function(f){if(instanceOf(f,Function)){f={initialize:f}}var e=function(){c(this);if(e.$prototyping){return this}this.$caller=null;var g=(this.initialize)?this.initialize.apply(this,arguments):this;this.$caller=this.caller=null;return g}.extend(this).implement(f);e.$constructor=a;e.prototype.$constructor=e;return e});var c=function(e){for(var f in e){var h=e[f];switch(typeOf(h)){case"object":var g=function(){};g.prototype=h;e[f]=c(new g);break;case"array":e[f]=h.clone();break}}return e};var d=function(e,f){if(a.Mutators.hasOwnProperty(e)){f=a.Mutators[e].call(this,f);if(f==null){return this}}if(typeOf(f)=="function"){if(f.$hidden){return this}this.prototype[e]=f}else{Object.merge(this.prototype,e,f)}return this};var b=function(e){e.$prototyping=true;var f=new e;delete e.$prototyping;return f};a.implement("implement",d.overloadSetter());a.Mutators={Extends:function(e){this.parent=e;this.prototype=b(e)},Implements:function(e){Array.from(e).each(function(h){var f=new h;for(var g in f){d.call(this,g,f[g],true)}},this)}}})();(function(){this.Chain=new Class({$chain:[],chain:function(){this.$chain.append(Array.flatten(arguments));return this},callChain:function(){return(this.$chain.length)?this.$chain.shift().apply(this,arguments):false},clearChain:function(){this.$chain.empty();return this}});var a=function(b){return b.replace(/^on([A-Z])/,function(c,d){return d.toLowerCase()})};this.Events=new Class({$events:{},addEvent:function(d,c,b){d=a(d);this.$events[d]=(this.$events[d]||[]).include(c);if(b){c.internal=true}return this},addEvents:function(b){for(var c in b){this.addEvent(c,b[c])}return this},fireEvent:function(e,c,b){e=a(e);var d=this.$events[e];if(!d){return this}c=Array.from(c);d.each(function(f){if(b){f.delay(b,this,c)}else{f.apply(this,c)}},this);return this},removeEvent:function(e,d){e=a(e);var c=this.$events[e];if(c&&!d.internal){var b=c.indexOf(d);if(b!=-1){delete c[b]}}return this},removeEvents:function(d){var e;if(typeOf(d)=="object"){for(e in d){this.removeEvent(e,d[e])}return this}if(d){d=a(d)}for(e in this.$events){if(d&&d!=e){continue}var c=this.$events[e];for(var b=c.length;b--;){if(b in c){this.removeEvent(e,c[b])}}}return this}});this.Options=new Class({setOptions:function(){var b=this.options=Object.merge.apply(null,[{},this.options].append(arguments));if(this.addEvent){for(var c in b){if(typeOf(b[c])!="function"||!(/^on[A-Z]/).test(c)){continue}this.addEvent(c,b[c]);delete b[c]}}return this}})})();if(typeof JSON=="undefined"){this.JSON={}}(function(){var special={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};var escape=function(chr){return special[chr]||"\\u"+("0000"+chr.charCodeAt(0).toString(16)).slice(-4)};JSON.validate=function(string){string=string.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");return(/^[\],:{}\s]*$/).test(string)};JSON.encode=JSON.stringify?function(obj){return JSON.stringify(obj)}:function(obj){if(obj&&obj.toJSON){obj=obj.toJSON()}switch(typeOf(obj)){case"string":return'"'+obj.replace(/[\x00-\x1f\\"]/g,escape)+'"';case"array":return"["+obj.map(JSON.encode).clean()+"]";case"object":case"hash":var string=[];Object.each(obj,function(value,key){var json=JSON.encode(value);if(json){string.push(JSON.encode(key)+":"+json)}});return"{"+string+"}";case"number":case"boolean":return""+obj;case"null":return"null"}return null};JSON.secure=true;JSON.decode=function(string,secure){if(!string||typeOf(string)!="string"){return null}if(secure==null){secure=JSON.secure}if(secure){if(JSON.parse){return JSON.parse(string)}if(!JSON.validate(string)){throw new Error("JSON could not decode the input; security is enabled and the value is not secure.")}}return eval("("+string+")")}})();Class.refactor=function(b,a){Object.each(a,function(e,d){var c=b.prototype[d];c=(c&&c.$origin)||c||function(){};b.implement(d,(typeof e=="function")?function(){var f=this.previous;this.previous=c;var g=e.apply(this,arguments);this.previous=f;return g}:e)});return b};(function(a){Array.implement({min:function(){return Math.min.apply(null,this)},max:function(){return Math.max.apply(null,this)},average:function(){return this.length?this.sum()/this.length:0},sum:function(){var b=0,c=this.length;if(c){while(c--){b+=this[c]}}return b},unique:function(){return[].combine(this)},shuffle:function(){for(var c=this.length;c&&--c;){var b=this[c],d=Math.floor(Math.random()*(c+1));this[c]=this[d];this[d]=b}return this},reduce:function(d,e){for(var c=0,b=this.length;c<b;c++){if(c in this){e=e===a?this[c]:d.call(null,e,this[c],c,this)}}return e},reduceRight:function(c,d){var b=this.length;while(b--){if(b in this){d=d===a?this[b]:c.call(null,d,this[b],b,this)}}return d}})})();(function(){var c={a:/[àáâãäåăą]/g,A:/[ÀÁÂÃÄÅĂĄ]/g,c:/[ćčç]/g,C:/[ĆČÇ]/g,d:/[ďđ]/g,D:/[ĎÐ]/g,e:/[èéêëěę]/g,E:/[ÈÉÊËĚĘ]/g,g:/[ğ]/g,G:/[Ğ]/g,i:/[ìíîï]/g,I:/[ÌÍÎÏ]/g,l:/[ĺľł]/g,L:/[ĹĽŁ]/g,n:/[ñňń]/g,N:/[ÑŇŃ]/g,o:/[òóôõöøő]/g,O:/[ÒÓÔÕÖØ]/g,r:/[řŕ]/g,R:/[ŘŔ]/g,s:/[ššş]/g,S:/[ŠŞŚ]/g,t:/[ťţ]/g,T:/[ŤŢ]/g,ue:/[ü]/g,UE:/[Ü]/g,u:/[ùúûůµ]/g,U:/[ÙÚÛŮ]/g,y:/[ÿý]/g,Y:/[ŸÝ]/g,z:/[žźż]/g,Z:/[ŽŹŻ]/g,th:/[þ]/g,TH:/[Þ]/g,dh:/[ð]/g,DH:/[Ð]/g,ss:/[ß]/g,oe:/[œ]/g,OE:/[Œ]/g,ae:/[æ]/g,AE:/[Æ]/g},b={" ":/[\xa0\u2002\u2003\u2009]/g,"*":/[\xb7]/g,"'":/[\u2018\u2019]/g,'"':/[\u201c\u201d]/g,"...":/[\u2026]/g,"-":/[\u2013]/g,"&raquo;":/[\uFFFD]/g};var a=function(f,h){var e=f,g;for(g in h){e=e.replace(h[g],g)}return e};var d=function(e,g){e=e||"";var h=g?"<"+e+"(?!\\w)[^>]*>([\\s\\S]*?)</"+e+"(?!\\w)>":"</?"+e+"([^>]+)?>",f=new RegExp(h,"gi");return f};String.implement({standardize:function(){return a(this,c)},repeat:function(e){return new Array(e+1).join(this)},pad:function(e,h,g){if(this.length>=e){return this}var f=(h==null?" ":""+h).repeat(e-this.length).substr(0,e-this.length);if(!g||g=="right"){return this+f}if(g=="left"){return f+this}return f.substr(0,(f.length/2).floor())+this+f.substr(0,(f.length/2).ceil())},getTags:function(e,f){return this.match(d(e,f))||[]},stripTags:function(e,f){return this.replace(d(e,f),"")},tidy:function(){return a(this,b)},truncate:function(e,f,i){var h=this;if(f==null&&arguments.length==1){f="…"}if(h.length>e){h=h.substring(0,e);if(i){var g=h.lastIndexOf(i);if(g!=-1){h=h.substr(0,g)}}if(f){h+=f}}return h}})})();(function(){var h=Array.prototype.slice;if(typeof module!=="undefined"&&module.exports){module.exports=g}else{if(typeof window!=="undefined"){window.co=g}else{this.co=g}}g.wrap=function(k){return function(){return g.call(this,k.apply(this,arguments))}};function g(p){var k=this;var n=undefined;try{if(typeof p==="function"){p=p.call(this)}}catch(q){n=q}if(!c(p)&&!e(p)){if(n===undefined){return p}throw n}return o()["catch"](function(r){if(!r.is_out&&r.stack){console.error(r.stack)}r.is_out=true;throw r});function o(s){var r;try{r=p.next(s)}catch(t){return Promise.reject(t)}return m(r)}function l(s){var r;try{r=p["throw"](s)}catch(t){return Promise.reject(t)}return m(r)}function m(r){if(r.done){return Promise.resolve(r.value)}var s=b.call(k,r.value);if(s&&e(s)){return s.then(o,l)}return o(r.value)}}function b(k){if(!k){return k}if(e(k)){return k}if(a(k)||c(k)){return g.call(this,k)}if("function"==typeof k){return f.call(this,k)}if(Array.isArray(k)){return i.call(this,k)}if(j(k)){return d.call(this,k)}return k}g.toPromise=b;function f(l){var k=this;return new Promise(function(n,m){l.call(k,function(p,o){if(p){return m(p)}if(arguments.length>2){o=h.call(arguments,1)}n(o)})})}function i(k){return Promise.all(k.map(b,this))}function d(p){var n=new p.constructor();var o=Object.keys(p);var m=[];for(var l=0;l<o.length;l++){var k=o[l];var r=b.call(this,p[k]);if(r&&e(r)){q(r,k)}else{n[k]=p[k]}}return Promise.all(m).then(function(){return n});function q(t,s){n[s]=undefined;m.push(t.then(function(u){n[s]=u}))}}function e(k){return k&&"function"==typeof k.then}g.isPromise=e;function c(k){return k&&"function"==typeof k.next&&"function"==typeof k["throw"]}g.isGenerator=c;g.isAsync=function(k){return e(k)||c(k)};function a(l){var k=l.constructor;return k&&"GeneratorFunction"==k.name}g.isGeneratorFunction=a;function j(k){return Object==k.constructor}}).call();(function(){if(!Date.prototype.Format){Date.prototype.Format=function(c){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(c)){c=c.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var d in e){if(new RegExp("("+d+")").test(c)){c=c.replace(RegExp.$1,(RegExp.$1.length==1)?(e[d]):(("00"+e[d]).substr((""+e[d]).length)))}}return c}}Date.fromISO=function(f){if(typeOf(f)!=="string"){return f}if(f.indexOf(":")===-1){f+=" 00:00:00"}var d=new Date(f);if(!isNaN(d)){return d}var c,k;var j=[/^(\d{4}\-\d\d\-\d\d([tT ][\d:\.]*)?)([zZ]|([+\-])(\d\d):(\d\d))?$/,/^\s*(\d{4})-(\d\d)-(\d\d)\s*$/];for(var e=0;e<j.length;e++){var h=j[e];var g=h.exec(f);if(g&&g[1]){c=g[1].split(/\D/).map(function(i){return parseInt(i,10)||0});c[1]-=1;c=new Date(Date.UTC.apply(Date,c));if(!c.getDate()){return f}if(g[5]){k=parseInt(g[5],10)*60;if(g[6]){k+=parseInt(g[6],10)}if(g[4]=="+"){k*=-1}if(k){c.setUTCMinutes(c.getUTCMinutes()+k)}}return c}}if(d===undefined||d===null||isNaN(d)){return null}return d};Object.isUNull=function(c){return c===undefined||c===null};String.prototype.format0=function(d,f,c){var e=this;if(d===undefined||d===null){d=""}if(!Array.isArray(d)){d=[d]}f=f||"{";c=c||"}";f=f.escapeRegExp();c=c.escapeRegExp();return e.replace(new RegExp(f+"(\\d+)"+c,"g"),function(g,h){if(d[h]===undefined||d[h]===null){d[h]=""}return d[h]})};String.isEmpty=function(d,c){if(d===undefined||d===null){return true}if(c!==false){d=String(d).trim()}else{d=String(d)}return d===""};if(String.prototype.startsWith===undefined){String.prototype.startsWith=function(c){return this.indexOf(c)===0}}if(String.prototype.endsWith===undefined){String.prototype.endsWith=function(d){var c=this;var e=c.lastIndexOf(d);if(e===-1){return false}return c.length-d.length===e}}if(String.prototype.reverse===undefined){String.prototype.reverse=function(){return this.split("").reverse().join("")}}if(RegExp.prototype.clone===undefined){RegExp.prototype.clone=function(){var c="";if(this.global===true){c+="g"}if(this.ignoreCase===true){c+="i"}if(this.multiline===true){c+="m"}return new RegExp(this.source,c)}}if(String.prototype.replaceLast===undefined){String.prototype.replaceLast=function(f,e){var d=this;var g=d.match(f);var c=0;return d.replace(f,function(h){c++;if(c===g.length){return e}return h})}}String.implement({windowsEncodePath:function(){var c=this.replace(/\&#(?!\d+;)/gm,"&#38;&#35;").replace(/\//gm,"&#47;").replace(/\\/gm,"&#92;").replace(/:/gm,"&#58;").replace(/\*/gm,"&#42;").replace(/\?/gm,"&#63;").replace(/"/gm,"&#34;").replace(/</gm,"&#60;").replace(/>/gm,"&#62;").replace(/\|/gm,"&#124;").replace(/ /gm,"€");return c},windowsDecodePath:function(){var c=this.replace(/\&#47;/gm,"/").replace(/\&#92;/gm,"\\").replace(/\&#58;/gm,":").replace(/\&#42;/gm,"*").replace(/\&#63;/gm,"?").replace(/\&#34;/gm,'"').replace(/\&#60;/gm,"<").replace(/\&#62;/gm,">").replace(/\&#124;/gm,"|").replace(/\&#38;\&#35;/gm,"&#").replace(/€/gm," ");return c},subSufix:function(d){var c=this;if(c.endsWith(d)){return c.substring(0,c.length-d.length)}return c},extname:function(f){var e=this;if(!f){f="."}var d=e.lastIndexOf(f);if(d===-1){return""}var c=e.substring(d);return c},basename:function(d){var c=this;var e=c.extname(d);if(e===""){return c}return c.subSufix(e)}});Events.implement({fireEvent:function(h,d,c){h=h.replace(/^on([A-Z])/,function(i,k){return k.toLowerCase()});var f=this.$events[h];if(!f){return this}d=Array.from(d);for(var e=0;e<f.length;e++){var g=f[e];if(c){g.delay(c,this,d)}else{var j=g.apply(this,d);if(j==="stopImmediatePropagation"){break}}}return this}});if(this.Wind){var b=Wind.Async.sleep;Wind.Async.sleep=function(c,d){if(c===0){return Wind.Async.Task.create(function(f){if(d&&d.isCancellationRequested){f.complete("failure",new CanceledError())}var e;var g;if(d){g=function(){clearTimeout(e);f.complete("failure",new CanceledError())}}var e=setImmediate(function(){if(d){d.unregister(g)}f.complete("success")});if(d){d.register(g)}})}else{return b.apply(this,arguments)}};var a=Wind.Async.Task.prototype._handleUnobservedError;Wind.Async.Task.prototype._handleUnobservedError=function(){try{a.apply(this,arguments)}catch(e){var d=e.children;if(d&&d.length!==undefined&&d.length!==null){for(var c=0;c<d.length;c++){var f=d[c];console.error(f.stack)}}if(e&&e.stack){console.error(e.stack)}throw e}}}if(this.Promise){Promise.fromCallback=function(c,d){return function(){var e=Array.from(arguments);if(!d){d=this}return new Promise(function(g,f){e.push(function(h){g(h)});if(c){c.apply(d,e)}else{g()}})}};Promise.fromStandard=function(c,d){return function(){var e=Array.from(arguments);if(!d){d=this}return new Promise(function(g,f){e.push(function(h,i){if(h){f(h);return}g(i)});if(c){c.apply(d,e)}else{g()}})}};Promise.sleep=function(c){return new Promise(function(e,d){setTimeout(function(){e()},c)})}}}).call();
var Dumper=(function(){var k=1000;var a=-1;var e=0;var c=1;var h=" ";var b="\n";var f=null;var j=null;function i(l,m){var o=new Array();for(var n=m;n<l.length;n++){o[o.length]=l[n]}return o}function d(l){var m="";for(var n=0;n<l;n++){m+=h}return m}function g(s){var t=1;var p=c;var l="";if(arguments.length>1&&typeof(arguments[1])=="number"){t=arguments[1];p=arguments[2];if(s==f){return"[original object]"}}else{e=0;f=s;if(arguments.length>1){var q=arguments;var r=1;if(typeof(arguments[1])=="object"){q=arguments[1];r=0}for(var m=r;m<q.length;m++){if(j==null){j=new Object()}j[q[m]]=1}}}if(e++>k){return"[Max Iterations Reached]"}if(a!=-1&&t>(a+1)){return"..."}if(typeof(s)=="undefined"){return"[undefined]"}if(s==null){return"[null]"}if(typeof(s)=="function"){return"[function]"}if(typeof(s)=="boolean"){return(s)?"true":"false"}if(typeof(s)=="string"){return"'"+s+"'"}if(typeof(s)=="number"){return s}if(typeof(s)=="object"){if(typeof(s.length)=="number"){if(a!=-1&&t>a){return"[ ... ]"}l="[";for(var m=0;m<s.length;m++){if(m>0){l+=","+b+d(p)}else{l+=b+d(p)}l+=g(s[m],t+1,p-0+c)}if(m>0){l+=b+d(p-c)}l+="]";return l}else{if(a!=-1&&t>a){return"{ ... }"}l="{";var n=0;for(m in s){if(s==f&&j!=null&&j[m]!=1){}else{if(typeof(s[m])!="unknown"){if(n++>0){l+=","+b+d(p)}else{l+=b+d(p)}l+="'"+m+"'=> "+g(s[m],t+1,p-0+m.length+5+c)}}}if(n>0){l+=b+d(p-c)}l+="}";return l}}}g.write=function(l){console.log(g(l,i(arguments,1)))};g.setMaxIterations=function(l){k=l};g.setMaxDepth=function(l){a=l};g.$VERSION=1;return g})();
var Timeago=(function(){var c=0,o=["second", "minute", "hour", "day", "week", "month", "year"],n=["秒", "分钟", "小时", "天", "周", "月", "年"],a={en:function(r,p){if(p===0){return["just now","right now"]}var q=o[parseInt(p/2)];if(r>1){q+="s"}return[r+" "+q+" ago","in "+r+" "+q]},zh_CN:function(r,p){if(p===0){return["刚刚","片刻后"]}var q=n[parseInt(p/2)];return[r+q+"前",r+q+"后"]}},d=[60,60,24,7,365/7/12,12],j=6,m="datetime";function i(p){if(p instanceof Date){return p}if(!isNaN(p)){return new Date(h(p))}if(/^\d+$/.test(p)){return new Date(h(p,10))}p=(p||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/T/," ").replace(/Z/," UTC").replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(p)}function h(p){return parseInt(p)}function g(s,p,r){p=a[p]?p:(a[r]?r:"en");var q=0;agoin=s<0?1:0;s=Math.abs(s);for(;s>=d[q]&&q<j;q++){s/=d[q]}s=h(s);q*=2;if(s>(q===0?9:1)){q+=1}return a[p](s,q)[agoin].replace("%s",s)}function f(q,p){p=p?i(p):new Date();return(p-i(q))/1000}function b(q){var s=1,p=0,r=Math.abs(q);for(;q>=d[p]&&p<j;p++){q/=d[p];s*=d[p]}r=r%s;r=r?s-r:s;return Math.ceil(r)}function l(p){if(p.getAttribute){return p.getAttribute(m)}if(p.attr){return p.attr(m)}}function e(p,s){var r={};if(!s){s="en"}function q(w,u,t,v){var x=f(u,p);w.innerHTML=g(x,t,s);r["k"+v]=setTimeout(function(){q(w,u,t,v)},b(x)*1000)}this.format=function(u,t){return g(f(u,p),t,s)};this.render=function(u,t){if(u.length===undefined){u=[u]}for(var v=0;v<u.length;v++){q(u[v],l(u[v]),t,++c)}};this.cancel=function(){for(var t in r){clearTimeout(r[t])}r={}};this.setLocale=function(t){s=t};return this}function k(p,q){return new e(p,q)}k.register=function(p,q){a[p]=q};return k})();
var t = undefined;
(function(){t = this;})();
t.global = t;
t.Dumper=Dumper;
t.Timeago = Timeago;
t.validation_gl = {
	email: function(str) {
		if(String.isEmpty(str)) return false;
		var reg = /^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;
		if(!reg.test(str)) return false;
		return true;
	}
};
t.rltSet_gl = [];
if(!Date.prototype.FormatUTC) {
	Date.prototype.FormatUTC = function(fmt) {
		var o = {
			"M+" : this.getUTCMonth()+1,                 //月份
			"d+" : this.getUTCDate(),                    //日
			"h+" : this.getUTCHours(),                   //小时
			"m+" : this.getUTCMinutes(),                 //分
			"s+" : this.getUTCSeconds(),                 //秒
			"q+" : Math.floor((this.getUTCMonth()+3)/3), //季度
			"S"  : this.getUTCMilliseconds()             //毫秒
		};
		if(/(y+)/.test(fmt))
			fmt=fmt.replace(RegExp.$1, (this.getUTCFullYear()+"").substr(4 - RegExp.$1.length));
		for(var k in o)
			if(new RegExp("("+ k +")").test(fmt))
		fmt = fmt.replace(RegExp.$1, (RegExp.$1.length==1) ? (o[k]) : (("00"+ o[k]).substr((""+ o[k]).length)));
		return fmt;
	};
}
Date.prototype.toJSON = function() {
	return this.FormatUTC("yyyy-MM-dd hh:mm:ss");
}
$$ language plv8;

create or replace function qk_rltSet_gl(key_name text) returns json as $$
  var rltSet = rltSet_gl[key_name];
  delete rltSet_gl[key_name];
  return rltSet;
$$ language plv8;
